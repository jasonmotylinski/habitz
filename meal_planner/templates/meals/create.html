{% extends "base.html" %}

{% block title %}Add Recipe - Meal Planner{% endblock %}

{% block content %}
<div class="multi-step-form">
    <!-- Form Header -->
    <div class="form-header">
        <h2>Add Recipe</h2>
        <p style="margin: var(--spacing-sm) 0 0 0; opacity: 0.9;">It takes just 4 steps to save your favorite meal</p>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
        <div class="progress-dot active" data-step="1"></div>
        <div class="progress-dot" data-step="2"></div>
        <div class="progress-dot" data-step="3"></div>
        <div class="progress-dot" data-step="4"></div>
    </div>

    <!-- Form -->
    <form method="POST" enctype="multipart/form-data" class="meal-form">
        {{ form.hidden_tag() }}

        <!-- Step 1: Meal Name & Description -->
        <div class="form-step active" data-step="1">
            <h3>What's this meal called?</h3>
            <p class="form-step-hint">
                üí° Give it a name that's meaningful to you. "Mom's Spaghetti" is perfect‚Äîyou don't need fancy names.
            </p>

            <div class="form-group">
                {{ form.name.label("Meal Name", class="form-label form-label-required") }}
                {{ form.name(class="form-control", placeholder="e.g., Mom's Spaghetti Bolognese", required=True, data_label="Meal name") }}
                {% if form.name.errors %}
                    <div class="form-error">{{ form.name.errors[0] }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.category.label("What type of meal is this?", class="form-label") }}
                {{ form.category(class="form-control") }}
                <small class="form-help">Choose a category like Chicken, Side, Dessert, etc.</small>
                {% if form.category.errors %}
                    <div class="form-error">{{ form.category.errors[0] }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.description.label("About This Meal (Optional)", class="form-label") }}
                {{ form.description(class="form-control", rows="3", placeholder="Any special notes? e.g., 'Family favorite, takes 30 minutes'") }}
                {% if form.description.errors %}
                    <div class="form-error">{{ form.description.errors[0] }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Step 2: Ingredients -->
        <div class="form-step" data-step="2">
            <h3>What do you need?</h3>
            <p class="form-step-hint">
                üí° List each ingredient on its own line. We'll turn this into a shopping list later!
            </p>

            <div class="form-group">
                {{ form.ingredients.label("Ingredients", class="form-label form-label-required") }}
                {{ form.ingredients(class="form-control", rows="8", placeholder="- 1 lb ground beef\n- 1 onion, chopped\n- 2 cups tomato sauce\n- Salt and pepper to taste", required=True, data_label="Ingredients") }}
                <small class="form-help">One ingredient per line. Include quantities.</small>
                {% if form.ingredients.errors %}
                    <div class="form-error">{{ form.ingredients.errors[0] }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Step 3: Instructions -->
        <div class="form-step" data-step="3">
            <h3>How do you make it?</h3>
            <p class="form-step-hint">
                üí° Write the instructions like you're telling a friend. Don't worry about perfect formatting.
            </p>

            <div class="form-group">
                {{ form.instructions.label("Instructions", class="form-label form-label-required") }}
                {{ form.instructions(class="form-control", rows="8", placeholder="1. Brown the ground beef in a large pot\n2. Add chopped onion and cook until soft\n3. Pour in tomato sauce and simmer for 20 minutes\n4. Season with salt and pepper to taste", required=True, data_label="Instructions") }}
                <small class="form-help">No fancy formatting needed. Just write naturally.</small>
                {% if form.instructions.errors %}
                    <div class="form-error">{{ form.instructions.errors[0] }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Step 4: Image -->
        <div class="form-step" data-step="4">
            <h3>Got a photo? (Optional)</h3>
            <p class="form-step-hint">
                üí° A photo helps you remember what this dish looks like. You can add one now or skip it.
            </p>

            <div class="form-group">
                {{ form.image.label("Meal Photo", class="form-label") }}
                {{ form.image(class="form-control", accept="image/*") }}
                <small class="form-help">JPG, PNG, or GIF. Max 16MB.</small>
                {% if form.image.errors %}
                    <div class="form-error">{{ form.image.errors[0] }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
            <button type="button" class="btn btn-outline" data-prev-step style="display: none;">
                ‚Üê Back
            </button>
            <button type="button" class="btn btn-primary" data-next-step>
                Next Step ‚Üí
            </button>
            {{ form.submit(class="btn btn-primary", data_submit_form=True, style="display: none;") }}
        </div>
    </form>
</div>

<!-- Additional help section -->
<section style="max-width: 600px; margin: var(--spacing-xl) auto; padding: var(--spacing-lg); background-color: rgba(135, 168, 120, 0.05); border-radius: var(--radius-lg); text-align: center;">
    <h4>Need help?</h4>
    <p style="margin: var(--spacing-sm) 0; color: #666;">
        You can always edit this recipe later, so don't worry about getting everything perfect the first time.
    </p>
    <a href="{{ url_for('meals.library') }}" style="color: var(--sage-green); text-decoration: none; font-weight: 500;">
        ‚Üê Back to Recipe Collection
    </a>
</section>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/meal-form.js') }}"></script>
{% endblock %}
